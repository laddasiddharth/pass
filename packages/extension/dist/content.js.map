{
  "version": 3,
  "sources": ["../src/content/content-script.ts"],
  "sourcesContent": ["/**\r\n * Content Script\r\n * \r\n * Runs in the context of web pages to detect login forms and enable autofill.\r\n * \r\n * SECURITY CONSTRAINTS:\r\n * - NO access to cryptographic operations\r\n * - NO access to decrypted vault data\r\n * - Can only request autofill via background worker\r\n * - Cannot read master password or encryption keys\r\n * \r\n * This script is intentionally minimal to maintain security boundaries.\r\n */\r\n\r\nconsole.log('[Content Script] Password Manager content script loaded')\r\n\r\n// ============================================================================\r\n// Form Detection\r\n// ============================================================================\r\n\r\nfunction detectLoginForms() {\r\n  const forms = document.querySelectorAll('form')\r\n  \r\n  forms.forEach(form => {\r\n    const passwordInputs = form.querySelectorAll('input[type=\"password\"]')\r\n    const usernameInputs = form.querySelectorAll('input[type=\"text\"], input[type=\"email\"]')\r\n    \r\n    if (passwordInputs.length > 0 && usernameInputs.length > 0) {\r\n      console.log('[Content Script] Login form detected')\r\n      addAutofillButton(form, usernameInputs[0] as HTMLInputElement, passwordInputs[0] as HTMLInputElement)\r\n    }\r\n  })\r\n}\r\n\r\n// ============================================================================\r\n// Autofill Button\r\n// ============================================================================\r\n\r\nfunction addAutofillButton(form: HTMLFormElement, usernameInput: HTMLInputElement, passwordInput: HTMLInputElement) {\r\n  // Check if button already exists\r\n  if (form.querySelector('.pm-autofill-btn')) {\r\n    return\r\n  }\r\n  \r\n  const button = document.createElement('button')\r\n  button.type = 'button'\r\n  button.className = 'pm-autofill-btn'\r\n  button.textContent = '\uD83D\uDD10 Autofill'\r\n  button.style.cssText = `\r\n    position: absolute;\r\n    top: -30px;\r\n    right: 0;\r\n    padding: 6px 12px;\r\n    background: #6366f1;\r\n    color: white;\r\n    border: none;\r\n    border-radius: 6px;\r\n    font-size: 12px;\r\n    font-weight: 600;\r\n    cursor: pointer;\r\n    z-index: 10000;\r\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\r\n  `\r\n  \r\n  button.addEventListener('click', async () => {\r\n    const currentUrl = window.location.href\r\n    \r\n    // Request autofill from background worker\r\n    chrome.runtime.sendMessage({\r\n      type: 'REQUEST_AUTOFILL',\r\n      url: currentUrl\r\n    }, (response) => {\r\n      if (response && response.success && response.entry) {\r\n        if (usernameInput) usernameInput.value = response.entry.username\r\n        if (passwordInput) passwordInput.value = response.entry.password\r\n        \r\n        // Trigger input events for frameworks like React\r\n        if (usernameInput) usernameInput.dispatchEvent(new Event('input', { bubbles: true }))\r\n        if (passwordInput) passwordInput.dispatchEvent(new Event('input', { bubbles: true }))\r\n        \r\n        button.textContent = '\u2713 Filled'\r\n        setTimeout(() => {\r\n          button.textContent = '\uD83D\uDD10 Autofill'\r\n        }, 2000)\r\n      } else {\r\n        button.textContent = '\u274C Not found'\r\n        setTimeout(() => {\r\n          button.textContent = '\uD83D\uDD10 Autofill'\r\n        }, 2000)\r\n      }\r\n    })\r\n  })\r\n  \r\n  // Position button relative to form\r\n  const formRect = form.getBoundingClientRect()\r\n  if (formRect.top > 40) {\r\n    form.style.position = 'relative'\r\n    form.appendChild(button)\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Initialize\r\n// ============================================================================\r\n\r\n// Detect forms on page load\r\nif (document.readyState === 'loading') {\r\n  document.addEventListener('DOMContentLoaded', detectLoginForms)\r\n} else {\r\n  detectLoginForms()\r\n}\r\n\r\n// Re-detect forms when DOM changes (for SPAs)\r\nconst observer = new MutationObserver(() => {\r\n  detectLoginForms()\r\n})\r\n\r\nif (document.body) {\r\n  observer.observe(document.body, {\r\n    childList: true,\r\n    subtree: true\r\n  })\r\n}\r\n\r\n// SECURITY NOTE: This content script has NO access to:\r\n// - Master password\r\n// - Derived encryption key\r\n// - Decrypted vault data\r\n// - Cryptographic operations\r\n// \r\n// All sensitive operations are handled by the background service worker.\r\n\r\n"],
  "mappings": "AAcA,QAAQ,IAAI,yDAAyD,EAMrE,SAASA,GAAmB,CACZ,SAAS,iBAAiB,MAAM,EAExC,QAAQC,GAAQ,CACpB,IAAMC,EAAiBD,EAAK,iBAAiB,wBAAwB,EAC/DE,EAAiBF,EAAK,iBAAiB,yCAAyC,EAElFC,EAAe,OAAS,GAAKC,EAAe,OAAS,IACvD,QAAQ,IAAI,sCAAsC,EAClDC,EAAkBH,EAAME,EAAe,CAAC,EAAuBD,EAAe,CAAC,CAAqB,EAExG,CAAC,CACH,CAMA,SAASE,EAAkBH,EAAuBI,EAAiCC,EAAiC,CAElH,GAAIL,EAAK,cAAc,kBAAkB,EACvC,OAGF,IAAMM,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,KAAO,SACdA,EAAO,UAAY,kBACnBA,EAAO,YAAc,qBACrBA,EAAO,MAAM,QAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAgBvBA,EAAO,iBAAiB,QAAS,SAAY,CAC3C,IAAMC,EAAa,OAAO,SAAS,KAGnC,OAAO,QAAQ,YAAY,CACzB,KAAM,mBACN,IAAKA,CACP,EAAIC,GAAa,CACXA,GAAYA,EAAS,SAAWA,EAAS,OACvCJ,IAAeA,EAAc,MAAQI,EAAS,MAAM,UACpDH,IAAeA,EAAc,MAAQG,EAAS,MAAM,UAGpDJ,GAAeA,EAAc,cAAc,IAAI,MAAM,QAAS,CAAE,QAAS,EAAK,CAAC,CAAC,EAChFC,GAAeA,EAAc,cAAc,IAAI,MAAM,QAAS,CAAE,QAAS,EAAK,CAAC,CAAC,EAEpFC,EAAO,YAAc,gBACrB,WAAW,IAAM,CACfA,EAAO,YAAc,oBACvB,EAAG,GAAI,IAEPA,EAAO,YAAc,mBACrB,WAAW,IAAM,CACfA,EAAO,YAAc,oBACvB,EAAG,GAAI,EAEX,CAAC,CACH,CAAC,EAGgBN,EAAK,sBAAsB,EAC/B,IAAM,KACjBA,EAAK,MAAM,SAAW,WACtBA,EAAK,YAAYM,CAAM,EAE3B,CAOI,SAAS,aAAe,UAC1B,SAAS,iBAAiB,mBAAoBP,CAAgB,EAE9DA,EAAiB,EAInB,IAAMU,EAAW,IAAI,iBAAiB,IAAM,CAC1CV,EAAiB,CACnB,CAAC,EAEG,SAAS,MACXU,EAAS,QAAQ,SAAS,KAAM,CAC9B,UAAW,GACX,QAAS,EACX,CAAC",
  "names": ["detectLoginForms", "form", "passwordInputs", "usernameInputs", "addAutofillButton", "usernameInput", "passwordInput", "button", "currentUrl", "response", "observer"]
}

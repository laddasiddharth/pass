var tt=BigInt(4294967295),At=BigInt(32);function mt(e,t=!1){return t?{h:Number(e&tt),l:Number(e>>At&tt)}:{h:Number(e>>At&tt)|0,l:Number(e&tt)|0}}var G=(e,t,r)=>e>>>r|t<<32-r,K=(e,t,r)=>e<<32-r|t>>>r,et=(e,t,r)=>e<<64-r|t>>>r-32,rt=(e,t,r)=>e>>>r-32|t<<64-r,nt=(e,t)=>t,ot=(e,t)=>e;function ht(e,t,r,o){let i=(t>>>0)+(o>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}var $=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),z=(e,t,r,o)=>t+r+o+(e/2**32|0)|0;function Ht(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function it(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function S(e,...t){if(!Ht(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ft(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function kt(e,t){S(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function N(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function P(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function L(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}var Bt=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Lt(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}var U=Bt?e=>e:e=>Lt(e);function _t(e){for(let t=0;t<e.length;t++)e[t]=Lt(e[t]);return e}var H=Bt?e=>e:_t;function Ut(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function R(e){return typeof e=="string"&&(e=Ut(e)),S(e),e}function ct(e){return typeof e=="string"&&(e=Ut(e)),S(e),e}var st=class{};function Et(e){let t=(o,i)=>e(i).update(R(o)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=o=>e(o),t}var St=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);var x=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),a=new Uint32Array(32);function T(e,t,r,o,i,n){let c=i[n],s=i[n+1],l=a[2*e],u=a[2*e+1],d=a[2*t],h=a[2*t+1],g=a[2*r],w=a[2*r+1],p=a[2*o],y=a[2*o+1],m=$(l,d,c);u=z(m,u,h,s),l=m|0,{Dh:y,Dl:p}={Dh:y^u,Dl:p^l},{Dh:y,Dl:p}={Dh:nt(y,p),Dl:ot(y,p)},{h:w,l:g}=ht(w,g,y,p),{Bh:h,Bl:d}={Bh:h^w,Bl:d^g},{Bh:h,Bl:d}={Bh:G(h,d,24),Bl:K(h,d,24)},a[2*e]=l,a[2*e+1]=u,a[2*t]=d,a[2*t+1]=h,a[2*r]=g,a[2*r+1]=w,a[2*o]=p,a[2*o+1]=y}function V(e,t,r,o,i,n){let c=i[n],s=i[n+1],l=a[2*e],u=a[2*e+1],d=a[2*t],h=a[2*t+1],g=a[2*r],w=a[2*r+1],p=a[2*o],y=a[2*o+1],m=$(l,d,c);u=z(m,u,h,s),l=m|0,{Dh:y,Dl:p}={Dh:y^u,Dl:p^l},{Dh:y,Dl:p}={Dh:G(y,p,16),Dl:K(y,p,16)},{h:w,l:g}=ht(w,g,y,p),{Bh:h,Bl:d}={Bh:h^w,Bl:d^g},{Bh:h,Bl:d}={Bh:et(h,d,63),Bl:rt(h,d,63)},a[2*e]=l,a[2*e+1]=u,a[2*t]=d,a[2*t+1]=h,a[2*r]=g,a[2*r+1]=w,a[2*o]=p,a[2*o+1]=y}function Ct(e,t={},r,o,i){if(it(r),e<0||e>r)throw new Error("outputLen bigger than keyLen");let{key:n,salt:c,personalization:s}=t;if(n!==void 0&&(n.length<1||n.length>r))throw new Error("key length must be undefined or 1.."+r);if(c!==void 0&&c.length!==o)throw new Error("salt must be undefined or "+o);if(s!==void 0&&s.length!==i)throw new Error("personalization must be undefined or "+i)}var pt=class extends st{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,it(t),it(r),this.blockLen=t,this.outputLen=r,this.buffer=new Uint8Array(t),this.buffer32=P(this.buffer)}update(t){ft(this),t=R(t),S(t);let{blockLen:r,buffer:o,buffer32:i}=this,n=t.length,c=t.byteOffset,s=t.buffer;for(let l=0;l<n;){this.pos===r&&(H(i),this.compress(i,0,!1),H(i),this.pos=0);let u=Math.min(r-this.pos,n-l),d=c+l;if(u===r&&!(d%4)&&l+u<n){let h=new Uint32Array(s,d,Math.floor((n-l)/4));H(h);for(let g=0;l+r<n;g+=i.length,l+=r)this.length+=r,this.compress(h,g,!1);H(h);continue}o.set(t.subarray(l,l+u),this.pos),this.pos+=u,this.length+=u,l+=u}return this}digestInto(t){ft(this),kt(t,this);let{pos:r,buffer32:o}=this;this.finished=!0,L(this.buffer.subarray(r)),H(o),this.compress(o,0,!0),H(o);let i=P(t);this.get().forEach((n,c)=>i[c]=U(n))}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let o=t.slice(0,r);return this.destroy(),o}_cloneInto(t){let{buffer:r,length:o,finished:i,destroyed:n,outputLen:c,pos:s}=this;return t||(t=new this.constructor({dkLen:c})),t.set(...this.get()),t.buffer.set(r),t.destroyed=n,t.finished=i,t.length=o,t.pos=s,t.outputLen=c,t}clone(){return this._cloneInto()}},yt=class extends pt{constructor(t={}){let r=t.dkLen===void 0?64:t.dkLen;super(128,r),this.v0l=x[0]|0,this.v0h=x[1]|0,this.v1l=x[2]|0,this.v1h=x[3]|0,this.v2l=x[4]|0,this.v2h=x[5]|0,this.v3l=x[6]|0,this.v3h=x[7]|0,this.v4l=x[8]|0,this.v4h=x[9]|0,this.v5l=x[10]|0,this.v5h=x[11]|0,this.v6l=x[12]|0,this.v6h=x[13]|0,this.v7l=x[14]|0,this.v7h=x[15]|0,Ct(r,t,64,16,16);let{key:o,personalization:i,salt:n}=t,c=0;if(o!==void 0&&(o=R(o),c=o.length),this.v0l^=this.outputLen|c<<8|65536|1<<24,n!==void 0){n=R(n);let s=P(n);this.v4l^=U(s[0]),this.v4h^=U(s[1]),this.v5l^=U(s[2]),this.v5h^=U(s[3])}if(i!==void 0){i=R(i);let s=P(i);this.v6l^=U(s[0]),this.v6h^=U(s[1]),this.v7l^=U(s[2]),this.v7h^=U(s[3])}if(o!==void 0){let s=new Uint8Array(this.blockLen);s.set(o),this.update(s)}}get(){let{v0l:t,v0h:r,v1l:o,v1h:i,v2l:n,v2h:c,v3l:s,v3h:l,v4l:u,v4h:d,v5l:h,v5h:g,v6l:w,v6h:p,v7l:y,v7h:m}=this;return[t,r,o,i,n,c,s,l,u,d,h,g,w,p,y,m]}set(t,r,o,i,n,c,s,l,u,d,h,g,w,p,y,m){this.v0l=t|0,this.v0h=r|0,this.v1l=o|0,this.v1h=i|0,this.v2l=n|0,this.v2h=c|0,this.v3l=s|0,this.v3h=l|0,this.v4l=u|0,this.v4h=d|0,this.v5l=h|0,this.v5h=g|0,this.v6l=w|0,this.v6h=p|0,this.v7l=y|0,this.v7h=m|0}compress(t,r,o){this.get().forEach((l,u)=>a[u]=l),a.set(x,16);let{h:i,l:n}=mt(BigInt(this.length));a[24]=x[8]^n,a[25]=x[9]^i,o&&(a[28]=~a[28],a[29]=~a[29]);let c=0,s=St;for(let l=0;l<12;l++)T(0,4,8,12,t,r+2*s[c++]),V(0,4,8,12,t,r+2*s[c++]),T(1,5,9,13,t,r+2*s[c++]),V(1,5,9,13,t,r+2*s[c++]),T(2,6,10,14,t,r+2*s[c++]),V(2,6,10,14,t,r+2*s[c++]),T(3,7,11,15,t,r+2*s[c++]),V(3,7,11,15,t,r+2*s[c++]),T(0,5,10,15,t,r+2*s[c++]),V(0,5,10,15,t,r+2*s[c++]),T(1,6,11,12,t,r+2*s[c++]),V(1,6,11,12,t,r+2*s[c++]),T(2,7,8,13,t,r+2*s[c++]),V(2,7,8,13,t,r+2*s[c++]),T(3,4,9,14,t,r+2*s[c++]),V(3,4,9,14,t,r+2*s[c++]);this.v0l^=a[0]^a[16],this.v0h^=a[1]^a[17],this.v1l^=a[2]^a[18],this.v1h^=a[3]^a[19],this.v2l^=a[4]^a[20],this.v2h^=a[5]^a[21],this.v3l^=a[6]^a[22],this.v3h^=a[7]^a[23],this.v4l^=a[8]^a[24],this.v4h^=a[9]^a[25],this.v5l^=a[10]^a[26],this.v5h^=a[11]^a[27],this.v6l^=a[12]^a[28],this.v6h^=a[13]^a[29],this.v7l^=a[14]^a[30],this.v7h^=a[15]^a[31],L(a)}destroy(){this.destroyed=!0,L(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},F=Et(e=>new yt(e));var lt={Argond2d:0,Argon2i:1,Argon2id:2},W=4,Tt=e=>e===void 0?Uint8Array.of():ct(e);function gt(e,t){let r=e&65535,o=e>>>16,i=t&65535,n=t>>>16,c=Math.imul(r,i),s=Math.imul(o,i),l=Math.imul(r,n),u=Math.imul(o,n),d=(c>>>16)+(s&65535)+l,h=u+(s>>>16)+(d>>>16)|0,g=d<<16|c&65535;return{h,l:g}}function Gt(e,t){let{h:r,l:o}=gt(e,t);return{h:(r<<1|o>>>31)&4294967295,l:o<<1&4294967295}}function at(e,t,r,o){let{h:i,l:n}=Gt(t,o),c=$(t,o,n);return{h:z(c,e,r,i),l:c|0}}var b=new Uint32Array(256);function O(e,t,r,o){let i=b[2*e],n=b[2*e+1],c=b[2*t],s=b[2*t+1],l=b[2*r],u=b[2*r+1],d=b[2*o],h=b[2*o+1];({h:n,l:i}=at(n,i,s,c)),{Dh:h,Dl:d}={Dh:h^n,Dl:d^i},{Dh:h,Dl:d}={Dh:nt(h,d),Dl:ot(h,d)},{h:u,l}=at(u,l,h,d),{Bh:s,Bl:c}={Bh:s^u,Bl:c^l},{Bh:s,Bl:c}={Bh:G(s,c,24),Bl:K(s,c,24)},{h:n,l:i}=at(n,i,s,c),{Dh:h,Dl:d}={Dh:h^n,Dl:d^i},{Dh:h,Dl:d}={Dh:G(h,d,16),Dl:K(h,d,16)},{h:u,l}=at(u,l,h,d),{Bh:s,Bl:c}={Bh:s^u,Bl:c^l},{Bh:s,Bl:c}={Bh:et(s,c,63),Bl:rt(s,c,63)},b[2*e]=i,b[2*e+1]=n,b[2*t]=c,b[2*t+1]=s,b[2*r]=l,b[2*r+1]=u,b[2*o]=d,b[2*o+1]=h}function Vt(e,t,r,o,i,n,c,s,l,u,d,h,g,w,p,y){O(e,i,l,g),O(t,n,u,w),O(r,c,d,p),O(o,s,h,y),O(e,n,d,y),O(t,c,h,g),O(r,s,l,w),O(o,i,u,p)}function X(e,t,r,o,i){for(let n=0;n<256;n++)b[n]=e[t+n]^e[r+n];for(let n=0;n<128;n+=16)Vt(n,n+1,n+2,n+3,n+4,n+5,n+6,n+7,n+8,n+9,n+10,n+11,n+12,n+13,n+14,n+15);for(let n=0;n<16;n+=2)Vt(n,n+1,n+16,n+17,n+32,n+33,n+48,n+49,n+64,n+65,n+80,n+81,n+96,n+97,n+112,n+113);if(i)for(let n=0;n<256;n++)e[o+n]^=b[n]^e[t+n]^e[r+n];else for(let n=0;n<256;n++)e[o+n]=b[n]^e[t+n]^e[r+n];L(b)}function wt(e,t){let r=N(e),o=new Uint32Array(1),i=N(o);if(o[0]=t,t<=64)return F.create({dkLen:t}).update(i).update(r).digest();let n=new Uint8Array(t),c=F.create({}).update(i).update(r).digest(),s=0;for(n.set(c.subarray(0,32)),s+=32;t-s>64;s+=32){let l=F.create({}).update(c);l.digestInto(c),l.destroy(),n.set(c.subarray(0,32),s)}return n.set(F(c,{dkLen:t-s}),s),L(c,o),P(n)}function Kt(e,t,r,o,i,n,c=!1){let s;e===0?t===0?s=i-1:c?s=t*o+i-1:s=t*o+(i==0?-1:0):c?s=r-o+i-1:s=r-o+(i==0?-1:0);let l=e!==0&&t!==W-1?(t+1)*o:0,u=s-1-gt(s,gt(n,n).h).h;return(l+u)%r}var Ot=Math.pow(2,32);function I(e){return Number.isSafeInteger(e)&&e>=0&&e<Ot}function Nt(e){let t={version:19,dkLen:32,maxmem:Ot-1,asyncTick:10};for(let[l,u]of Object.entries(e))u!=null&&(t[l]=u);let{dkLen:r,p:o,m:i,t:n,version:c,onProgress:s}=t;if(!I(r)||r<4)throw new Error("dkLen should be at least 4 bytes");if(!I(o)||o<1||o>=Math.pow(2,24))throw new Error("p should be 1 <= p < 2^24");if(!I(i))throw new Error("m should be 0 <= m < 2^32");if(!I(n)||n<1)throw new Error("t (iterations) should be 1 <= t < 2^32");if(s!==void 0&&typeof s!="function")throw new Error("progressCb should be function");if(!I(i)||i<8*o)throw new Error("memory should be at least 8*p bytes");if(c!==16&&c!==19)throw new Error("unknown version="+c);return t}function Rt(e,t,r,o){if(e=ct(e),t=ct(t),S(e),S(t),!I(e.length))throw new Error("password should be less than 4 GB");if(!I(t.length)||t.length<8)throw new Error("salt should be at least 8 bytes and less than 4 GB");if(!Object.values(lt).includes(r))throw new Error("invalid type");let{p:i,dkLen:n,m:c,t:s,version:l,key:u,personalization:d,maxmem:h,onProgress:g,asyncTick:w}=Nt(o);u=Tt(u),d=Tt(d);let p=F.create({}),y=new Uint32Array(1),m=N(y);for(let k of[i,n,c,s,l,r])y[0]=k,p.update(m);for(let k of[e,t,u,d])y[0]=k.length,p.update(m).update(k);let A=new Uint32Array(18),B=N(A);p.digestInto(B);let D=i,v=4*i*Math.floor(c/(W*i)),E=Math.floor(v/i),J=Math.floor(E/W),M=v*256;if(!I(h)||M>h)throw new Error("mem should be less than 2**32, got: maxmem="+h+", memused="+M);let dt=new Uint32Array(M);for(let k=0;k<i;k++){let q=256*E*k;A[17]=k,A[16]=0,dt.set(wt(A,1024),q),A[16]=1,dt.set(wt(A,1024),q+256)}let xt=()=>{};if(g){let k=s*W*i*J,q=Math.max(Math.floor(k/1e4),1),Q=0;xt=()=>{Q++,g&&(!(Q%q)||Q===k)&&g(Q/k)}}return L(y,A),{type:r,mP:v,p:i,t:s,version:l,B:dt,laneLen:E,lanes:D,segmentLen:J,dkLen:n,perBlock:xt,asyncTick:w}}function Ft(e,t,r,o){let i=new Uint32Array(256);for(let c=0;c<t;c++)for(let s=0;s<256;s++)i[s]^=e[256*(r*c+r-1)+s];let n=N(wt(i,o));return L(i),n}function jt(e,t,r,o,i,n,c,s,l,u,d,h,g){u%c&&(d=u-1);let w,p;if(h){let B=n%128;B===0&&(t[268]++,X(t,256,2*256,0,!1),X(t,0,2*256,0,!1)),w=t[2*B],p=t[2*B+1]}else{let B=256*d;w=e[B],p=e[B+1]}let y=o===0&&i===0?r:p%l,m=Kt(o,i,c,s,n,w,y==r),A=c*y+m;X(e,256*d,256*A,u*256,g)}function Jt(e,t,r,o){let{mP:i,p:n,t:c,version:s,B:l,laneLen:u,lanes:d,segmentLen:h,dkLen:g,perBlock:w}=Rt(t,r,e,o),p=new Uint32Array(3*256);p[262]=i,p[264]=c,p[266]=e;for(let y=0;y<c;y++){let m=y!==0&&s===19;p[256]=y;for(let A=0;A<W;A++){p[260]=A;let B=e==lt.Argon2i||e==lt.Argon2id&&y===0&&A<2;for(let D=0;D<n;D++){p[258]=D,p[268]=0;let v=0;y===0&&A===0&&(v=2,B&&(p[268]++,X(p,256,2*256,0,!1),X(p,0,2*256,0,!1)));let E=D*u+A*h+v,J=E%u?E-1:E+u-1;for(let M=v;M<h;M++,E++,J++)w(),jt(l,p,D,y,A,M,u,h,d,E,J,B,m)}}}return L(p),Ft(l,n,u,g)}var It=(e,t,r)=>Jt(lt.Argon2id,e,t,r);var $t={iterations:3,parallelism:4,memorySize:2**16,hashLength:32,type:"id"};async function Y(e,t,r){let o={...$t,...r};t||(t=crypto.getRandomValues(new Uint8Array(16)));let i;typeof e=="string"?i=new TextEncoder().encode(e):i=e;let n=It(i,t,{t:o.iterations,m:o.memorySize,p:o.parallelism});return{key:await crypto.subtle.importKey("raw",n.slice(0,o.hashLength),{name:"AES-GCM"},!1,["encrypt","decrypt"]),salt:t}}var vt="AES-GCM";async function _(e,t){let r=crypto.getRandomValues(new Uint8Array(12)),o=JSON.stringify(e),i=new TextEncoder().encode(o),n=await crypto.subtle.encrypt({name:vt,iv:r},t.key,i);return{ciphertext:bt(new Uint8Array(n)),iv:bt(r),salt:bt(t.salt),algorithm:"AES-256-GCM",derivationAlgorithm:"Argon2id"}}async function ut(e,t){let r=Dt(e.ciphertext),o=Dt(e.iv);try{let i=await crypto.subtle.decrypt({name:vt,iv:o},t.key,r),n=new TextDecoder().decode(i);return JSON.parse(n)}catch{throw new Error("Decryption failed. This could be due to incorrect password or corrupted data.")}}function bt(e){let t="";for(let r=0;r<e.byteLength;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function Dt(e){let t=atob(e),r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r}var f={userId:null,derivedKey:null,decryptedVault:null,isLocked:!0,lastActivity:Date.now()},zt=15*60*1e3,Z="http://localhost:3001",j=null;function C(){f.lastActivity=Date.now(),j!==null&&clearTimeout(j),j=setTimeout(()=>{Mt()},zt)}function Mt(){console.log("[Background] Locking vault and clearing sensitive data"),f.userId=null,f.derivedKey=null,f.decryptedVault=null,f.isLocked=!0,j!==null&&(clearTimeout(j),j=null),chrome.runtime.sendMessage({type:"VAULT_LOCKED"}).catch(()=>{})}chrome.runtime.onMessage.addListener((e,t,r)=>(console.log("[Background] Received message:",e.type),Wt(e,t).then(r).catch(o=>{console.error("[Background] Error handling message:",o),r({success:!1,error:o.message})}),!0));async function Wt(e,t){switch(e.type){case"UNLOCK_VAULT":return await Xt(e);case"ADD_PASSWORD":return await Yt(e);case"DELETE_PASSWORD":return await qt(e);case"UPDATE_PASSWORD":return await Qt(e);case"GET_VAULT":return Zt();case"LOCK_VAULT":return te();case"GET_STATUS":return ee();case"HEARTBEAT":return C(),{success:!0};default:return Promise.resolve({success:!1,error:"Unknown message type"})}}async function Xt(e){try{console.log("[Background] Unlocking vault for user:",e.userId);let t=await fetch(`${Z}/api/vault/${e.userId}`);if(!t.ok){if(t.status===404){console.log("[Background] No vault found, creating new vault");let s=await Y(e.masterPassword),l=[],u=await _({site:"VAULT_ROOT",username:"SYSTEM",password:JSON.stringify(l)},s);return await fetch(`${Z}/api/vault/${e.userId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),f.userId=e.userId,f.derivedKey=s,f.decryptedVault=l,f.isLocked=!1,C(),{success:!0}}throw new Error(`Backend error: ${t.statusText}`)}let r=await t.json(),o=re(r.salt),i=await Y(e.masterPassword,o),n=await ut(r,i),c=JSON.parse(n.password);return f.userId=e.userId,f.derivedKey=i,f.decryptedVault=c,f.isLocked=!1,C(),console.log("[Background] Vault unlocked successfully"),{success:!0}}catch(t){return console.error("[Background] Failed to unlock vault:",t),f.userId=null,f.derivedKey=null,f.decryptedVault=null,f.isLocked=!0,{success:!1,error:t.message||"Failed to unlock vault. Check your master password."}}}async function Yt(e){if(f.isLocked||!f.derivedKey||!f.decryptedVault)return{success:!1,error:"Vault is locked"};try{f.decryptedVault.push(e.entry);let t=await _({site:"VAULT_ROOT",username:"SYSTEM",password:JSON.stringify(f.decryptedVault)},f.derivedKey),r=f.userId;return await fetch(`${Z}/api/vault/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),C(),{success:!0}}catch(t){return console.error("[Background] Failed to add password:",t),{success:!1,error:t.message}}}function Zt(){return f.isLocked||!f.decryptedVault?{success:!1,error:"Vault is locked"}:(C(),{success:!0,vault:f.decryptedVault})}async function qt(e){if(f.isLocked||!f.derivedKey||!f.decryptedVault)return{success:!1,error:"Vault is locked"};try{f.decryptedVault=f.decryptedVault.filter(o=>o.id!==e.entryId);let t=await _({site:"VAULT_ROOT",username:"SYSTEM",password:JSON.stringify(f.decryptedVault)},f.derivedKey),r=f.userId;return await fetch(`${Z}/api/vault/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),C(),{success:!0}}catch(t){return console.error("[Background] Failed to delete password:",t),{success:!1,error:t.message}}}async function Qt(e){if(f.isLocked||!f.derivedKey||!f.decryptedVault)return{success:!1,error:"Vault is locked"};try{let t=f.decryptedVault.findIndex(i=>i.id===e.entry.id);if(t===-1)return{success:!1,error:"Entry not found"};f.decryptedVault[t]={...e.entry,updatedAt:new Date().toISOString()};let r=await _({site:"VAULT_ROOT",username:"SYSTEM",password:JSON.stringify(f.decryptedVault)},f.derivedKey),o=f.userId;return await fetch(`${Z}/api/vault/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),C(),{success:!0}}catch(t){return console.error("[Background] Failed to update password:",t),{success:!1,error:t.message}}}function te(){return Mt(),{success:!0}}function ee(){return{isLocked:f.isLocked}}function re(e){try{let t=atob(e),r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r}catch(t){return console.error("[Background] Failed to decode base64:",t),new Uint8Array(0)}}chrome.runtime.onInstalled.addListener(()=>{console.log("[Background] Extension installed")});chrome.runtime.onStartup.addListener(()=>{console.log("[Background] Browser started - vault is locked by default")});console.log("[Background] Service worker initialized - vault is locked");
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=background.js.map
